<html>

<head>
  <meta charset="utf-8">
  <title>Experiment Annotation Tracker</title>
  <link rel="stylesheet" type="text/css" href="semantic/dist/semantic.min.css">
  <script src="lib/jquery-3.4.1.min.js"></script>
  <script src="semantic/dist/semantic.min.js"></script>

  <!--- Video CSS --->
  <link rel="stylesheet" href="player.css"/>

  <!--- Site CSS -->
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/reset.css">
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/site.css">
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/grid.css">

  <!--- Component CSS -->
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/menu.css">
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/input.css">
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/dropdown.css">
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/icon.css">
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/button.css">
  <link rel="stylesheet" type="text/css" href="semantic/dist/components/transition.css">

  <script type="text/javascript" src="semantic/dist/components/dropdown.js"></script>

  <!-- This is the code for opening and closing dropdowns. -->
  <script>
    $(document)
      .ready(function () {
        $('.ui.menu .ui.dropdown').dropdown({
          on: 'hover'
        });
        $('.ui.menu a.item')
          .on('click', function () {
            $(this)
              .addClass('active')
              .siblings()
              .removeClass('active')
              ;
          })
          ;
      })
      ;
  </script>
</head>

<body>

  <!-- The Menu bar -->
  <div class="ui menu">
    <div class="header item">COOL</div>
    <div class="ui dropdown item">
      Experiment
      <i class="dropdown icon"></i>
      <div class="menu">
        <div class="item">New</div>
        <div class="item">Open</div>
      </div>
    </div>
    <a class="item" id="subjects-option">Subjects</a>
    <div class="ui dropdown item">
      Score
      <i class="dropdown icon"></i>
      <div class="menu">
        <div class="item" id="behaviour-parameters-option">Behavior Parameters</div>
        <div class="item" id="scoring-option">Start Scoring Session</div>
      </div>
    </div>
    <a class="item" id="analysis-option">Analysis</a>
  </div>

  <!-- The Main View -->
  <!-- This should be hidden on start up and turned on only with javascript, that way we can tell users to enable javascript to run this program. -->
  <div class="ui segment" id="experiment-view">
    <div class="ui two column very relaxed grid">
      <!-- The Inputs Column is where most of the information is collected from the user. 
        It can dynamically switch between the Experiment, scoring, subject, and analysis views. -->
      <div class="column" id="inputs-column">

        <!-- This header of the left hand column displays the title of the form being viewed -->
        <h2 class="ui dividing header" id="left-title" style="display: none"></h2>

        <!-- This form is for entering and modifying the subjects of a particular experiment. -->
        <div id="subjects-form" style="display: none"></div>

        <!-- This form is for entering and modifying the behaviour parameters that will be scored during a particular scoring session. -->
        <div class="ui two column very relaxed grid" id="behaviour-parameters-form" style="display: none">
          <div class="column">
            <div class="ui form" id="behaviour-parameter-list">
              <div id="behaviour-parameter-row-1">
                <div class="inline fields">
                  <div class="four wide field">
                    <label>1</label>
                    <input type="text" placeholder="Key">
                  </div>
                  <div class="five wide field">
                    <input type="text" placeholder="Behaviour">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="column">
            <div class="ui vertical buttons">
              <button class="ui button" id="add-behaviour-parameter-button">Add</button>
              <button class="ui secondary button" id="save-behaviour-parameters-button">Save</button>
            </div>
          </div>
        </div>

        <!-- This form is for conducting the scoring session. -->
        <div id="scoring-form" style="display: none"></div>

        <!-- This form is for inputting the parameters for scoring session analysis. -->
        <div id="analysis-form" style="display: none"></div>

      </div>
      <!-- This column contains all the video manipulation and scoring session interactions. -->
      <div class="column" id="video-column">
        <div id="container">
          <div id="videoButtons">
            <button id="btnVideoPlay"><i class="play icon"></i></button>
            <button id="btnVideoPause"><i class="pause icon"></i></button>
            <button id="btnVideoStop"><i class="stop icon"></i></button>
            <button id="btnVideoBackwards"><i class="backward icon"></i></button>
            <button id="btnVideoForwards"><i class="forward icon"></i></button>
            <button id="btnVideoFastBackwards"><i class="fast backward icon"></i></button>
            <button id="btnVideoFastForwards"><i class="fast forward icon"></i></button>
            <output id="outputCurrentVideoSpeed">Video Speed: 1x</output>
            <button id="btnAddVideo"><i class="plus square outline icon"></i></button>
          </div>
          <video id="myVideo" controls="controls"></video> <!--controls="controls" enables default video player controls. Delete to remove functionality.-->
          <div id="trackerButtons">
            <output id="outputTrackerScoring">Scoring Time (sec): 0</output>
            <button id="btnTrackerPlay"><i class="play icon"></i></button>
            <button id="btnTrackerPause"><i class="pause icon"></i></button>
            <button id="btnTrackerStop"><i class="stop icon"></i></button>
          </div>
        </div>
        <script src="player.js"></script>
      </div>
    </div>

    <!-- This needs to come third, for some reason. -->
    <div class="ui vertical divider">&lt; &gt;</div>
  </div>

  <script>
    // Title of the left pane
    const leftTitle = document.getElementById("left-title");
    // Objects of all the forms
    const behaviourParametersForm = document.getElementById("behaviour-parameters-form");
    const subjectsForm = document.getElementById("subjects-form");
    const scoringForm = document.getElementById("scoring-form");
    const analysisForm = document.getElementById("analysis-form");

    function clearTitleAndHideForms() {
      let forms = [behaviourParametersForm, subjectsForm, scoringForm, analysisForm];

      function hideForm(form) {
        form.style.display = 'none';
      };

      leftTitle.style.display = 'none';
      forms.forEach(hideForm);

    };

    const subjectsOption = document.getElementById("subjects-option");
    subjectsOption.addEventListener(
      'click',
      function showSubjectsForm() {
        clearTitleAndHideForms();
        leftTitle.innerHTML = "Subjects";
        leftTitle.style.display = '';
        subjectsForm.style.display = '';
      }
    );

    const behaviourParametersOption = document.getElementById("behaviour-parameters-option");
    behaviourParametersOption.addEventListener(
      'click',
      function showBehaviorParametersForm() {
        clearTitleAndHideForms();
        leftTitle.innerHTML = "Behaviour Parameters";
        leftTitle.style.display = '';
        behaviourParametersForm.style.display = '';
      }
    );

    const scoringOption = document.getElementById("scoring-option");
    scoringOption.addEventListener(
      'click',
      function showScoringForm() {
        clearTitleAndHideForms();
        leftTitle.innerHTML = "Scoring";
        leftTitle.style.display = '';
        scoringForm.style.display = '';
      }
    );

    const analysisOption = document.getElementById("analysis-option");
    analysisOption.addEventListener(
      'click',
      function showAnalysisForm() {
        clearTitleAndHideForms();
        leftTitle.innerHTML = "Analysis";
        leftTitle.style.display = '';
        analysisForm.style.display = '';
      }
    );

    const addBehaviourParameterButton = document.getElementById("add-behaviour-parameter-button");
    let rowCounter = 1;
    addBehaviourParameterButton.addEventListener(
      'click',
      function addBehaviourParameterRow() {
        let behaviourParameterList = document.querySelector("#behaviour-parameter-list");
        let index = { text: ++rowCounter };
        behaviourParameterList.insertAdjacentHTML("beforeend",
          `
          <div id="behaviour-parameter-row-${index.text}">
            <div class="inline fields">
              <div class="four wide field">
                <label>${index.text}</label>
                <input type="text" placeholder="Key">
              </div>
              <div class="five wide field">
                <input type="text" placeholder="Behaviour">
              </div>
              <i class="close icon" id="behaviour-parameter-row-close-icon-${index.text}"></i>
          </div>
          `
        );
        let id = "behaviour-parameter-row-close-icon-".concat(rowCounter);
        let behaviourParameterRowCloseIcon = document.querySelector("#behaviour-parameter-row-close-icon-".concat(rowCounter));
        behaviourParameterRowCloseIcon.addEventListener(
          'click',
          function removeBehaviourParameterRow() {
            let behaviourParameterRow = behaviourParameterRowCloseIcon.parentElement;
            behaviourParameterRow.remove();
            rowCounter--;
          }
        )
      }
    );
  </script>
</body>
</html>